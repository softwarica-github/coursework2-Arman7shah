import os
import tkinter as tk
from tkinter import filedialog, messagebox
import hashlib

def calculate_file_hash(file_path, chunk_size=8192):
    hash_md5 = hashlib.md5()
    with open(file_path, "rb") as f:
        for chunk in iter(lambda: f.read(chunk_size), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

def scan_file(file_path):
    known_malicious_hashes = [
        "d41d8cd98f00b204e9800998ecf8427e","virus",".exe",".bat",".vbs","5A 4D 4E 55 52 56 45 4D",".txt",".bat"
    ]
    file_hash = calculate_file_hash(file_path)

    if file_hash in known_malicious_hashes:
        return True

    return False


def remove_malicious_file(file_path):
    try:
        os.remove(file_path)
        messagebox.showinfo("Removed", f"The file '{os.path.basename(file_path)}' has been removed due to its malicious nature.")
    except Exception as e:
        messagebox.showerror("Error", f"Failed to remove the file: {str(e)}")

def browse_files():
    file_path = filedialog.askopenfilename()
    if file_path:
        is_malicious = scan_file(file_path)
        if is_malicious:
            response = messagebox.askyesno("Malware Detected", f"The file '{os.path.basename(file_path)}' is potentially harmful! Do you want to remove it?")
            if response:
                remove_malicious_file(file_path)
            else:
                messagebox.showinfo("Decision", "You chose not to remove the file.")
        else:
            messagebox.showinfo("Safe", f"The file '{os.path.basename(file_path)}' is safe.")

# GUI setup
app = tk.Tk()
app.title("malware detection and removal")
app.geometry("400x200")
app.configure(bg="#2f4155")

label = tk.Label(app, text="Select a file to scan:")
label.pack(pady=10)

browse_button = tk.Button(app, text="Browse", command=browse_files)
browse_button.pack()


app.mainloop()